<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Casino Royal</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        /* åˆæœŸã®é’ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’å³å®ˆ */
        body { 
            background: linear-gradient(135deg, #0f172a 0%, #1a1a1a 100%); 
            color: white; 
            font-family: 'Hiragino Kaku Gothic Pro', sans-serif;
            text-align: center; 
            min-height: 100vh;
            margin: 0;
        }
        header {
            padding: 30px;
            background: rgba(0,0,0,0.3);
            border-bottom: 2px solid #1e40af;
        }
        .card { 
            background: #1e293b; /* åˆæœŸã®é’ãƒ™ãƒ¼ã‚¹ */
            padding: 25px; 
            margin: 15px; 
            border-radius: 15px; 
            display: inline-block; 
            min-width: 320px; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
            border: 1px solid #334155;
        }
        #slotDisplay { 
            font-size: 50px; 
            background: #020617; 
            margin: 20px 0; 
            padding: 20px; 
            border-radius: 10px;
            border: 2px solid #fbbf24;
            letter-spacing: 5px;
        }
        input { 
            width: 100px; 
            padding: 10px; 
            background: #0f172a;
            color: white;
            border: 1px solid #475569;
            border-radius: 6px;
            font-size: 1.1rem;
        }
        button { 
            padding: 10px 25px; 
            cursor: pointer; 
            background: #fbbf24;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            color: #000;
        }
        button:hover { background: #f59e0b; }
        
        #loginOverlay { 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.95); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            z-index: 1000; 
        }
        .result { font-weight: bold; height: 30px; margin-top: 15px; font-size: 1.2rem; }
        #log { margin-top: 30px; font-size: 12px; color: #94a3b8; }
    </style>
</head>
<body>

<div id="loginOverlay">
    <div class="card">
        <h2 style="color:#fbbf24;">CASINO LOGIN</h2>
        <p>åå‰ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ±ºã‚ã¦å…¥åº—</p>
        <input type="text" id="uName" placeholder="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å"><br><br>
        <input type="password" id="uPass" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"><br><br>
        <button onclick="login()">å…¥åº—ã™ã‚‹</button>
        <p id="err" style="color:#f87171; margin-top:15px;"></p>
    </div>
</div>

<header>
    <h1 style="color:#fbbf24;">ğŸ° MY CASINO ROYAL</h1>
    <div style="font-size: 1.2rem;">
        ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼: <span id="myName">-</span> | 
        ãƒãƒƒãƒ—: <span id="chips" style="color:#fbbf24;">0</span> æš
    </div>
</header>

<div class="card">
    <h3>SLOT MACHINE</h3>
    <div id="slotDisplay">ğŸ’ ğŸ’ 7ï¸âƒ£</div>
    <div style="margin-bottom: 10px;">
        BET: <input type="number" id="sBet" value="100">
    </div>
    <button onclick="spin()">SPIN!</button>
    <div id="sRes" class="result"></div>
</div>

<div class="card">
    <h3>HIGH & LOW</h3>
    <p style="color:#94a3b8; font-size:0.8rem;">ãƒ‡ã‚£ãƒ¼ãƒ©ãƒ¼ã«å‹ã¦ã°2å€é…å½“</p>
    <div style="margin-bottom: 10px;">
        BET: <input type="number" id="dBet" value="100">
    </div>
    <button onclick="double()">å‹è² </button>
    <div id="dRes" class="result"></div>
</div>

<div class="card" style="text-align: left;">
    <h4 style="color:#fbbf24; margin-top:0;">ğŸ† TOP 5</h4>
    <div id="rList"></div>
</div>

<div id="log"></div>

<script>
    const socket = io();
    let myChips = 0;

    function login() {
        const name = document.getElementById('uName').value;
        const pass = document.getElementById('uPass').value;
        if(name && pass) socket.emit('login_request', {name, password: pass});
    }

    socket.on('login_success', d => {
        document.getElementById('loginOverlay').style.display = 'none';
        document.getElementById('myName').textContent = d.name;
        myChips = d.chips;
        document.getElementById('chips').textContent = myChips.toLocaleString();
    });

    socket.on('login_error', m => document.getElementById('err').textContent = m);

    function spin() {
        const bet = parseInt(document.getElementById('sBet').value);
        if(bet > myChips) return alert("ãƒãƒƒãƒ—ä¸è¶³");
        socket.emit('spin_request', {bet});
    }

    socket.on('spin_result', d => {
        const display = document.getElementById('slotDisplay');
        const resEl = document.getElementById('sRes');
        let count = 0;
        const syms = ["ğŸ’", "ğŸ’", "7ï¸âƒ£", "ğŸ‹", "â­"];
        const interval = setInterval(() => {
            display.textContent = syms[Math.floor(Math.random()*5)] + " " + syms[Math.floor(Math.random()*5)] + " " + syms[Math.floor(Math.random()*5)];
            if (count++ > 15) {
                clearInterval(interval);
                display.textContent = d.result.join(" ");
                myChips = d.newChips;
                document.getElementById('chips').textContent = myChips.toLocaleString();
                resEl.textContent = d.win > 0 ? "WIN! +" + d.win : "LOSE";
                resEl.style.color = d.win > 0 ? "#4ade80" : "#f87171";
            }
        }, 50);
    });

    function double() {
        const bet = parseInt(document.getElementById('dBet').value);
        if(bet > myChips) return alert("ãƒãƒƒãƒ—ä¸è¶³");
        socket.emit('double_up_request', {bet});
    }

    socket.on('double_up_result', d => {
        myChips = d.newChips;
        document.getElementById('chips').textContent = myChips.toLocaleString();
        const resEl = document.getElementById('dRes');
        resEl.textContent = d.message;
        resEl.style.color = d.win > 0 ? "#4ade80" : "#f87171";
    });

    socket.on('update_ranking', list => {
        document.getElementById('rList').innerHTML = list.map((u, i) => 
            `<div>${i+1}. ${u.name}: ${u.chips.toLocaleString()}æš</div>`).join("");
    });

    socket.on('broadcast', m => {
        const l = document.getElementById('log');
        l.innerHTML = `<div>> ${m}</div>` + l.innerHTML;
    });
</script>
</body>
</html>
