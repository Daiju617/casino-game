<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Casino - Official Service</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        /* --- Âü∫Êú¨„Çπ„Çø„Ç§„É´ --- */
        body {
            background-color: #1a1a1a;
            color: #ffffff;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        /* --- „Éò„ÉÉ„ÉÄ„Éº„ÉªÊÉÖÂ†±Ë°®Á§∫ --- */
        header {
            background-color: #000000;
            padding: 20px;
            border-bottom: 2px solid #ffd700;
            margin-bottom: 20px;
        }

        .status-bar {
            font-size: 1.2rem;
            margin-top: 10px;
        }

        #chips {
            color: #ffd700;
            font-weight: bold;
            font-size: 1.4rem;
        }

        /* --- „Ç´„Éº„ÉâÔºà„Ç≤„Éº„É†„Ç®„É™„Ç¢Ôºâ --- */
        .card {
            background-color: #2d2d2d;
            border: 1px solid #444;
            border-radius: 12px;
            padding: 25px;
            margin: 15px;
            display: inline-block;
            vertical-align: top;
            min-width: 320px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        /* --- „Çπ„É≠„ÉÉ„Éà„Éá„Ç£„Çπ„Éó„É¨„Ç§ --- */
        #slotDisplay {
            font-size: 48px;
            background-color: #000;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border: 2px solid #555;
            letter-spacing: 10px;
            min-height: 60px;
        }

        /* --- ÂÖ•Âäõ„Å®„Éú„Çø„É≥ --- */
        .input-group {
            margin: 15px 0;
        }

        input[type="number"], input[type="text"], input[type="password"] {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #555;
            background: #000;
            color: #fff;
            font-size: 1rem;
            text-align: center;
        }

        button {
            padding: 10px 25px;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            transition: background 0.3s, transform 0.1s;
            background-color: #ffd700;
            color: #000;
        }

        button:hover {
            background-color: #ffea00;
            transform: scale(1.05);
        }

        button:active {
            transform: scale(0.95);
        }

        /* --- „É≠„Ç∞„Ç§„É≥ÁîªÈù¢ --- */
        #loginOverlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        /* --- „É©„É≥„Ç≠„É≥„Ç∞ --- */
        .ranking-box {
            text-align: left;
            margin-top: 15px;
            padding: 10px;
            background: #111;
            border-radius: 5px;
        }

        .rank-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid #333;
        }

        /* --- „É°„ÉÉ„Çª„Éº„Ç∏„Éª„É≠„Ç∞ --- */
        .result-msg {
            font-weight: bold;
            height: 24px;
            margin: 10px 0;
        }

        #gameLog {
            width: 80%;
            max-width: 800px;
            height: 120px;
            margin: 20px auto;
            background: #000;
            padding: 10px;
            overflow-y: scroll;
            font-size: 0.9rem;
            color: #888;
            border: 1px solid #333;
            text-align: left;
        }
    </style>
</head>
<body>

<div id="loginOverlay">
    <div class="card">
        <h2 style="color:#ffd700;">WELCOME TO CASINO</h2>
        <p>ÂêçÂâç„Å®„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
        <div class="input-group">
            <input type="text" id="uName" placeholder="„Éó„É¨„Ç§„É§„ÉºÂêç" style="width: 200px;"><br><br>
            <input type="password" id="uPass" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ" style="width: 200px;">
        </div>
        <button onclick="login()">„É≠„Ç∞„Ç§„É≥ / Êñ∞Ë¶èÁôªÈå≤</button>
        <p id="loginError" style="color: #ff4d4d; margin-top: 15px;"></p>
    </div>
</div>

<header>
    <h1>ULTIMATE CASINO</h1>
    <div class="status-bar">
        „Éó„É¨„Ç§„É§„Éº: <span id="myName">-</span> | 
        ÊâÄÊåÅ„ÉÅ„ÉÉ„Éó: <span id="chips">0</span> Êûö
    </div>
</header>

<main>
    <div class="card">
        <h3>SLOT MACHINE</h3>
        <div id="slotDisplay">üçí üíé 7Ô∏è‚É£</div>
        <div class="input-group">
            „Éô„ÉÉ„ÉàÈ°ç: <input type="number" id="sBet" value="100" min="10">
        </div>
        <button onclick="spin()">SPIN!</button>
        <div id="sRes" class="result-msg"></div>
    </div>

    <div class="card">
        <h3>HIGH & LOW</h3>
        <p style="font-size: 0.8rem; color: #aaa;">„Éá„Ç£„Éº„É©„Éº„ÅÆÊï∞Â≠ó(0-9)„Çà„ÇäÂ§ß„Åç„Åë„Çå„Å∞2ÂÄçÔºÅ</p>
        <div class="input-group">
            „Éô„ÉÉ„ÉàÈ°ç: <input type="number" id="dBet" value="100" min="10">
        </div>
        <button onclick="double()">ÂãùË≤†„Åô„Çã</button>
        <div id="dRes" class="result-msg"></div>
    </div>

    <div class="card" style="width: 320px;">
        <h3>üèÜ TOP RANKING</h3>
        <div id="rList" class="ranking-box">
            </div>
    </div>
</main>

<div id="gameLog">
    <div>„Ç∑„Çπ„ÉÜ„É†Ëµ∑ÂãïÂÆå‰∫Ü... Êé•Á∂ö„ÇíÂæÖÊ©ü‰∏≠„ÄÇ</div>
</div>

<script>
    const socket = io();
    let myChips = 0;

    // --- „É≠„Ç∞„Ç§„É≥Âá¶ÁêÜ ---
    function login() {
        const name = document.getElementById('uName').value.trim();
        const pass = document.getElementById('uPass').value.trim();
        
        if (!name || !pass) {
            alert("ÂêçÂâç„Å®„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ");
            return;
        }

        socket.emit('login_request', { name: name, password: pass });
    }

    // „É≠„Ç∞„Ç§„É≥ÊàêÂäü
    socket.on('login_success', (data) => {
        document.getElementById('loginOverlay').style.display = 'none';
        document.getElementById('myName').textContent = data.name;
        myChips = data.chips;
        updateChipDisplay();
    });

    // „É≠„Ç∞„Ç§„É≥Â§±Êïó
    socket.on('login_error', (msg) => {
        document.getElementById('loginError').textContent = msg;
    });

    // --- „Çπ„É≠„ÉÉ„ÉàÂá¶ÁêÜ ---
    function spin() {
        const bet = parseInt(document.getElementById('sBet').value);
        if (isNaN(bet) || bet <= 0) return alert("Ê≠£„Åó„ÅÑÈ°ç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ");
        if (bet > myChips) return alert("„ÉÅ„ÉÉ„Éó„ÅåË∂≥„Çä„Åæ„Åõ„Çì");

        document.getElementById('sRes').textContent = "ÂõûËª¢‰∏≠...";
        socket.emit('spin_request', { bet: bet });
    }

    socket.on('spin_result', (data) => {
        const display = document.getElementById('slotDisplay');
        const resEl = document.getElementById('sRes');
        let count = 0;
        
        const symbols = ["üçí", "üíé", "7Ô∏è‚É£", "üçã", "‚≠ê"];
        const interval = setInterval(() => {
            display.textContent = symbols[Math.floor(Math.random()*5)] + " " + 
                                symbols[Math.floor(Math.random()*5)] + " " + 
                                symbols[Math.floor(Math.random()*5)];
            
            if (count++ > 15) {
                clearInterval(interval);
                display.textContent = data.result.join(" ");
                myChips = data.newChips;
                updateChipDisplay();

                if (data.win > 0) {
                    resEl.textContent = "WIN! +" + data.win;
                    resEl.style.color = "#00ff88";
                } else {
                    resEl.textContent = "LOSE";
                    resEl.style.color = "#ff4d4d";
                }
            }
        }, 50);
    });

    // --- „ÉÄ„Éñ„É´„Ç¢„ÉÉ„ÉóÂá¶ÁêÜ ---
    function double() {
        const bet = parseInt(document.getElementById('dBet').value);
        if (isNaN(bet) || bet <= 0) return alert("Ê≠£„Åó„ÅÑÈ°ç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ");
        if (bet > myChips) return alert("„ÉÅ„ÉÉ„Éó„ÅåË∂≥„Çä„Åæ„Åõ„Çì");

        socket.emit('double_up_request', { bet: bet });
    }

    socket.on('double_up_result', (data) => {
        myChips = data.newChips;
        updateChipDisplay();
        
        const resEl = document.getElementById('dRes');
        resEl.textContent = data.message;
        
        if (data.win > parseInt(document.getElementById('dBet').value)) {
            resEl.style.color = "#00ff88";
        } else if (data.win === 0) {
            resEl.style.color = "#ff4d4d";
        } else {
            resEl.style.color = "#ffffff";
        }
    });

    // --- ÂÖ±ÈÄöÂá¶ÁêÜ ---
    function updateChipDisplay() {
        document.getElementById('chips').textContent = myChips.toLocaleString();
    }

    socket.on('update_ranking', (list) => {
        const html = list.map((u, i) => `
            <div class="rank-item">
                <span>${i+1}. ${u.name}</span>
                <span style="color:#ffd700;">${u.chips.toLocaleString()}Êûö</span>
            </div>
        `).join("");
        document.getElementById('rList').innerHTML = html;
    });

    socket.on('broadcast', (msg) => {
        const log = document.getElementById('gameLog');
        log.innerHTML = `<div>> ${msg}</div>` + log.innerHTML;
    });
</script>
</body>
</html>
