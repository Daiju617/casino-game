<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Ultimate Online Casino</title>
<script src="/socket.io/socket.io.js"></script>
<style>
/* ã‚ãªãŸã®ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’å®Œå…¨å¾©å…ƒ */
:root{
    --bg:#050510;
    --accent:#0ff;
    --accent2:#ff00ff;
    --panel:#0b0b1a;
    --text:#e0ffff;
}
*{ box-sizing:border-box; }
body{
    margin:0;
    min-height:100vh;
    background: radial-gradient(circle at top, #202040 0, #050510 55%, #000 100%);
    font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    color:var(--text);
    text-align:center;
    display:flex;
    flex-direction:column;
    align-items:center;
}
header{ padding:25px 10px 10px; }
h1{
    margin:0; font-size:2.6rem; letter-spacing:0.15em;
    text-shadow: 0 0 10px var(--accent), 0 0 25px var(--accent2), 0 0 40px #fff;
}
h1 span{ display:inline-block; transform:skewX(-8deg); }
#chipBar{
    margin-top:10px; display:inline-flex; align-items:center; gap:10px; padding:6px 14px;
    border-radius:999px; background:linear-gradient(90deg,rgba(0,255,255,0.15),rgba(255,0,255,0.15));
    border:1px solid rgba(0,255,255,0.5); box-shadow:0 0 15px rgba(0,255,255,0.4); font-weight:bold;
}
#chips{ font-size:1.4rem; color:#fff; text-shadow:0 0 8px var(--accent); }

main{ width:100%; max-width:1100px; padding:10px 15px 40px; display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; }

.section{
    position:relative; background:radial-gradient(circle at top left,#1a1a3a,#050510 60%);
    border-radius:18px; padding:18px 16px 20px; border:1px solid rgba(0,255,255,0.4);
    box-shadow: 0 0 25px rgba(0,255,255,0.25), 0 0 40px rgba(255,0,255,0.15); overflow:hidden;
}
.section-title{ display:flex; justify-content:center; align-items:center; gap:8px; margin-bottom:10px; }
.section-title span.label{ padding:3px 10px; border-radius:999px; border:1px solid rgba(0,255,255,0.5); font-size:0.8rem; text-transform:uppercase; opacity:0.8; }

.control-row{ display:flex; justify-content:center; flex-wrap:wrap; gap:8px; margin-bottom:10px; }
input[type="number"], input[type="text"]{ 
    width:110px; padding:6px 12px; border-radius:999px; border:1px solid rgba(0,255,255,0.6); 
    background:rgba(0,0,0,0.6); color:var(--text); text-align:center;
}
button{
    background:linear-gradient(135deg,#111,#222); color:var(--accent); border-radius:999px;
    border:1px solid rgba(0,255,255,0.7); padding:7px 14px; cursor:pointer; font-weight:600;
    transition: all 0.2s;
}
button:hover{ background:var(--accent); color:#000; box-shadow:0 0 12px rgba(0,255,255,0.8); }

.slot-frame{ display:inline-block; padding:6px 16px; border-radius:14px; border:1px solid rgba(0,255,255,0.6); background:rgba(0,0,0,0.5); }
.slot{ font-size:2.4rem; margin:10px 0 4px; letter-spacing:0.3em; }
.result{ margin-top:8px; min-height:22px; font-weight:bold; }
.result.win{ color:#00ff9d; text-shadow:0 0 8px #00ff9d; }

/* ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
#loginOverlay { 
    position:fixed; inset:0; background:rgba(0,0,0,0.95); z-index:1000; 
    display:flex; align-items:center; justify-content:center; 
}

/* ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ»ãƒ­ã‚°ç”¨è¿½åŠ  */
#rankArea { margin-top: 15px; text-align: left; font-size: 0.9rem; border-top: 1px solid rgba(0,255,255,0.2); padding-top: 10px; }
.rank-item { display: flex; justify-content: space-between; margin-bottom: 4px; color: rgba(224,255,255,0.8); }
#gameLog { font-size:0.75rem; text-align:left; height:120px; overflow-y:auto; background:rgba(0,0,0,0.3); padding:10px; border-radius:10px; border:1px solid rgba(255,0,255,0.2); }
</style>
</head>
<body>

<div id="loginOverlay">
    <div class="section" style="width:320px;">
        <div class="section-title"><span class="label">ACCOUNT</span><h2>LOGIN</h2></div>
        <p style="font-size:0.8rem; opacity:0.7;">ãƒãƒƒãƒ—ã¯ã‚¯ãƒ©ã‚¦ãƒ‰ã«è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™</p>
        <div class="control-row">
            <input type="text" id="userNameInput" placeholder="åå‰ã‚’å…¥åŠ›..." style="width:80%;">
        </div>
        <button onclick="login()">ã‚«ã‚¸ãƒã«ãƒ­ã‚°ã‚¤ãƒ³</button>
    </div>
</div>

<header>
    <h1><span>ğŸ’ ULTIMATE ONLINE ğŸ’</span></h1>
    <div id="chipBar">
        <span id="displayName" style="color:var(--accent2);">---</span>
        <span> | æ‰€æŒãƒãƒƒãƒ—:</span>
        <span id="chips">1000</span>
    </div>
</header>

<main>
    <section class="section">
        <div class="section-title">
            <span class="label">MACHINE</span>
            <h2>ğŸ° ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ»ã‚¹ãƒ­ãƒƒãƒˆ</h2>
        </div>
        <div class="control-row">
            <input type="number" id="slotBet" value="10">
            <button onclick="requestSpin()">ã‚¹ãƒ”ãƒ³</button>
        </div>
        <div class="slot-frame">
            <div class="slot" id="slotDisplay">ğŸ² ğŸ² ğŸ²</div>
        </div>
        <div id="slotResult" class="result"></div>
        
        <div id="rankArea">
            <div style="font-weight:bold; color:var(--accent); margin-bottom:8px; letter-spacing:0.1em;">ğŸ† TOP PLAYERS</div>
            <div id="rankingList"></div>
        </div>
    </section>

    <section class="section">
        <div class="section-title">
            <span class="label">GLOBAL</span>
            <h2>ğŸ“¢ ãƒ©ã‚¤ãƒ–ãƒ»ãƒ­ã‚°</h2>
        </div>
        <div id="gameLog"></div>
        <div style="margin-top:20px; padding:10px; border:1px dashed var(--accent); border-radius:10px; font-size:0.8rem; opacity:0.8;">
            ä»–ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå¤§å½“ãŸã‚Šã‚’å‡ºã™ã¨ã“ã“ã«é€šçŸ¥ã•ã‚Œã¾ã™ã€‚
        </div>
    </section>
</main>

<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<script>
    // ã‚µãƒ¼ãƒãƒ¼ã®URLã‚’è‡ªå‹•åˆ¤å®šï¼ˆRenderç’°å¢ƒã«å¯¾å¿œï¼‰
    const socket = io(); 
    let myChips = 0;

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ãƒ­ã‚°ã‚¤ãƒ³ã‚’æœ‰åŠ¹ã«ã™ã‚‹
    window.onload = () => {
        console.log("ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†");
    };

    // --- ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç† ---
    function login() {
        const nameInput = document.getElementById('userNameInput');
        const name = nameInput.value.trim();
        
        if (!name) {
            alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
            return;
        }

        // ãƒœã‚¿ãƒ³ã‚’é€£æ‰“ã§ããªã„ã‚ˆã†ã«ä¸€æ™‚ç„¡åŠ¹åŒ–
        const btn = event.target;
        btn.disabled = true;
        btn.textContent = "æ¥ç¶šä¸­...";

        console.log("ãƒ­ã‚°ã‚¤ãƒ³é€ä¿¡:", name);
        socket.emit('login_request', name);
    }

    // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”
    socket.on('login_success', (data) => {
        document.getElementById('loginOverlay').style.display = 'none';
        document.getElementById('displayName').textContent = data.name;
        myChips = data.chips;
        document.getElementById('chips').textContent = myChips.toLocaleString();
    });

    // ã‚¹ãƒ­ãƒƒãƒˆå®Ÿè¡Œ
    function requestSpin() {
        const bet = parseInt(document.getElementById('slotBet').value);
        if (isNaN(bet) || bet <= 0) return alert("ãƒ™ãƒƒãƒˆé¡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
        if (bet > myChips) return alert("ãƒãƒƒãƒ—ãŒè¶³ã‚Šã¾ã›ã‚“");
        
        document.getElementById('slotResult').textContent = "æŠ½é¸ä¸­...";
        socket.emit('spin_request', { bet: bet });
    }

    socket.on('spin_result', (data) => {
        const display = document.getElementById('slotDisplay');
        const chipDisplay = document.getElementById('chips');
        const resEl = document.getElementById('slotResult');
        const symbols = ["ğŸ’", "ğŸ’", "7ï¸âƒ£", "ğŸ‹", "â­"];
        let count = 0;
        
        const interval = setInterval(() => {
            display.textContent = symbols[Math.floor(Math.random()*5)] + " " + symbols[Math.floor(Math.random()*5)] + " " + symbols[Math.floor(Math.random()*5)];
            if (count++ > 15) {
                clearInterval(interval);
                display.textContent = data.result.join(" ");
                myChips = data.newChips;
                chipDisplay.textContent = myChips.toLocaleString();
                
                if (data.win > 0) {
                    resEl.textContent = `HIT! +${data.win}`;
                    resEl.className = "result win";
                } else {
                    resEl.textContent = "LOSE";
                    resEl.className = "result";
                }
            }
        }, 50);
    });

    socket.on('update_ranking', (list) => {
        const html = list.map((p, i) => `
            <div class="rank-item">
                <span>${i+1}. ${p.name}</span>
                <span>${p.chips.toLocaleString()}æš</span>
            </div>
        `).join("");
        document.getElementById('rankingList').innerHTML = html;
    });

    socket.on('broadcast', (msg) => {
        const log = document.getElementById('gameLog');
        log.innerHTML = `<div>${msg}</div>` + log.innerHTML;
    });
</script>
</body>
</html>

