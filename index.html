<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>NEON CASINO</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        /* „ÅîÊèêÁ§∫„ÅÑ„Åü„Å†„ÅÑ„Åü„Éá„Ç∂„Ç§„É≥„ÇíÈÅ©Áî® */
        :root{
            --bg:#050510;
            --accent:#0ff;
            --accent2:#ff00ff;
            --panel:#0b0b1a;
            --text:#e0ffff;
        }
        *{ box-sizing:border-box; }
        body{
            margin:0;
            min-height:100vh;
            background: radial-gradient(circle at top, #202040 0, #050510 55%, #000 100%);
            font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            color:var(--text);
            text-align:center;
            display:flex; flex-direction:column; align-items:center;
        }
        header{ padding:25px 10px 10px; }
        h1{
            margin:0; font-size:2.6rem; letter-spacing:0.15em;
            text-shadow: 0 0 10px var(--accent), 0 0 25px var(--accent2), 0 0 40px #fff;
        }
        h1 span{ display:inline-block; transform:skewX(-8deg); }
        #chipBar{
            margin-top:10px; display:inline-flex; align-items:center; gap:10px; padding:6px 14px;
            border-radius:999px; background:linear-gradient(90deg,rgba(0,255,255,0.15),rgba(255,0,255,0.15));
            border:1px solid rgba(0,255,255,0.5); box-shadow:0 0 15px rgba(0,255,255,0.4); font-weight:bold;
        }
        #chips{ font-size:1.4rem; color:#fff; text-shadow:0 0 8px var(--accent); }
        main{
            width:100%; max-width:1100px; padding:10px 15px 40px;
            display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px;
        }
        .section{
            position:relative; background:radial-gradient(circle at top left,#1a1a3a,#050510 60%);
            border-radius:18px; padding:18px 16px 20px; border:1px solid rgba(0,255,255,0.4);
            box-shadow: 0 0 25px rgba(0,255,255,0.25), 0 0 40px rgba(255,0,255,0.15); overflow:hidden;
        }
        .control-row{ display:flex; justify-content:center; gap:8px; margin-bottom:10px; }
        input[type="number"], input[type="text"], input[type="password"] {
            padding:6px 12px; border-radius:999px; border:1px solid rgba(0,255,255,0.6);
            background:rgba(0,0,0,0.6); color:var(--text);
        }
        button{
            background:linear-gradient(135deg,#111,#222); color:var(--accent);
            border-radius:999px; border:1px solid rgba(0,255,255,0.7); padding:7px 18px;
            cursor:pointer; font-weight:600; transition: 0.1s;
        }
        button:hover{ background:var(--accent); color:#000; box-shadow:0 0 12px var(--accent); }
        .slot-frame{
            font-size:2.4rem; margin:10px 0; padding:6px 16px; border-radius:14px;
            border:1px solid rgba(0,255,255,0.6); background:rgba(0,0,0,0.5);
        }
        .result{ margin-top:8px; min-height:22px; font-weight:bold; }
        .win{ color:#00ff9d; text-shadow:0 0 8px #00ff9d; }
        .lose{ color:#ff4d6a; text-shadow:0 0 8px #ff4d6a; }
        #loginOverlay {
            position: fixed; inset: 0; background: var(--bg);
            display: flex; justify-content: center; align-items: center; z-index: 1000;
        }
    </style>
</head>
<body>

<div id="loginOverlay">
    <div class="section" style="width:320px;">
        <h2 style="color:var(--accent);">LOGIN / SIGNUP</h2>
        <div style="margin-top:20px;">
            <input type="text" id="uName" placeholder="PLAYER NAME" style="width:100%; margin-bottom:10px;"><br>
            <input type="password" id="uPass" placeholder="PASSWORD" style="width:100%; margin-bottom:20px;"><br>
            <button onclick="login()" style="width:100%;">ACCESS SYSTEM</button>
            <p id="err" style="color:var(--accent2); font-size:0.8rem; margin-top:10px;"></p>
        </div>
    </div>
</div>

<header>
    <h1><span>NEON</span> CASINO</h1>
    <div id="chipBar">
        STATUS: <span id="chips">0</span> CHIPS
    </div>
    <div style="margin-top:10px; font-size:0.9rem;">PLAYER: <span id="myName">-</span></div>
</header>

<main>
    <div class="section">
        <div class="section-title"><span class="label">Cyber Slot</span></div>
        <div class="slot-frame" id="slotDisplay">üçí üíé 7Ô∏è‚É£</div>
        <div class="control-row">
            <input type="number" id="sBet" value="100" min="10">
            <button onclick="spin()">SPIN</button>
        </div>
        <div id="sRes" class="result"></div>
    </div>

    <div class="section">
        <div class="section-title"><span class="label">High & Low</span></div>
        <div style="margin:20px 0; font-size:0.9rem; opacity:0.8;">BEAT THE DEALER'S CARD</div>
        <div class="control-row">
            <input type="number" id="dBet" value="100" min="10">
            <button onclick="double()">DUEL</button>
        </div>
        <div id="dRes" class="result"></div>
    </div>

    <div class="section">
        <div class="section-title"><span class="label">Ranking</span></div>
        <div id="rList" style="text-align:left; padding:10px; font-size:0.9rem;"></div>
    </div>
</main>

<div id="log" style="width:100%; padding:20px; font-size:0.8rem; color:rgba(0,255,255,0.4); border-top:1px solid rgba(0,255,255,0.1);"></div>

<script>
    const socket = io();
    let myChips = 0;

    function login() {
        const name = document.getElementById('uName').value;
        const password = document.getElementById('uPass').value;
        if(name && password) socket.emit('login_request', {name, password});
    }

    socket.on('login_success', d => {
        document.getElementById('loginOverlay').style.display = 'none';
        document.getElementById('myName').textContent = d.name;
        myChips = d.chips;
        document.getElementById('chips').textContent = myChips.toLocaleString();
    });

    socket.on('login_error', m => document.getElementById('err').textContent = m);

    function spin() {
        const bet = parseInt(document.getElementById('sBet').value);
        if(bet > myChips) return alert("INSUFFICIENT CHIPS");
        socket.emit('spin_request', {bet});
    }

    socket.on('spin_result', d => {
        const display = document.getElementById('slotDisplay');
        const resEl = document.getElementById('sRes');
        let count = 0;
        const syms = ["üçí", "üíé", "7Ô∏è‚É£", "üçã", "‚≠ê"];
        const interval = setInterval(() => {
            display.textContent = syms[Math.floor(Math.random()*5)] + " " + syms[Math.floor(Math.random()*5)] + " " + syms[Math.floor(Math.random()*5)];
            if (count++ > 15) {
                clearInterval(interval);
                display.textContent = d.result.join(" ");
                myChips = d.newChips;
                document.getElementById('chips').textContent = myChips.toLocaleString();
                resEl.className = "result " + (d.win > 0 ? "win" : "lose");
                resEl.textContent = d.win > 0 ? "WIN +" + d.win : "LOSE";
            }
        }, 50);
    });

    function double() {
        const bet = parseInt(document.getElementById('dBet').value);
        if(bet > myChips) return alert("INSUFFICIENT CHIPS");
        socket.emit('double_up_request', {bet});
    }

    socket.on('double_up_result', d => {
        myChips = d.newChips;
        document.getElementById('chips').textContent = myChips.toLocaleString();
        const resEl = document.getElementById('dRes');
        resEl.className = "result " + (d.win > 0 ? "win" : "lose");
        resEl.textContent = d.message;
    });

    socket.on('update_ranking', list => {
        document.getElementById('rList').innerHTML = list.map((u, i) => 
            `<div style="margin-bottom:5px;">${i+1}. ${u.name} - ${u.chips.toLocaleString()}</div>`).join("");
    });

    socket.on('broadcast', m => {
        const l = document.getElementById('log');
        l.innerHTML = `<div>> ${m}</div>` + l.innerHTML;
    });
</script>
</body>
</html>
